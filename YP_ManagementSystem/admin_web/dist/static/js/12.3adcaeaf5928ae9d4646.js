webpackJsonp([12],{"0jwr":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),s=a("BO1k"),o=a.n(s),n=Vue.filter("formatDate"),l={data:function(){var e=this;return{tableFormat:[{prop:"UserName",label:"账号",width:"150"},{prop:"Name",label:"姓名",width:"150"},{prop:"PrjName",label:"项目名称"},{prop:"CreateTimeStr",label:"创建时间",width:"180"}],options:{button:!0,buttonText:!0,maxButtons:2},dataList:[],dataCount:0,pageindex:1,pagesize:10,accountData:[],projectList:[],dataListLoading:!1,addFormVisible:!1,editFormVisible:!1,form:{username:"",prjid:""},addform:{username:"",userid:"",prjids:[]},editform:{username:"",userid:"",prjids:[]},activeIndex:"",rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"},{validator:function(t,a,r){e.ajax("账号搜索",{username:a},function(t,a){null===t?e.$message({message:a.msg,type:"error"}):(e.accountData=t.data,t.data.length?r():r(new Error("账号不存在或已绑定项目,请检查!")))})},trigger:"blur"}],prjids:[{required:!0,message:"请选择项目",trigger:"change"}]},loadingBtnState:{searchState:!1,addState:!1,editState:!1}}},created:function(){this.init()},methods:{init:function(){this.getDataList(),this.getProjectList()},handleCurrentChange:function(e){this.addform.username=e.UserName,this.addform.userid=e.ID},getProjectList:function(){var e=this;this.ajax("账号绑定页所有项目",{},function(t,a){null===t?e.$message({message:a.msg,type:"error"}):e.projectList=t.data})},currentChange:function(e){this.pageindex=e||1,this.getDataList()},getDataList:function(){var e=this;this.loadingBtnState.searchState=!0;var t={start:(this.pageindex-1)*this.pagesize,size:this.pagesize};for(var a in this.form)""!==this.form[a]&&(t[a]=this.form[a]);this.dataListLoading=!0,this.ajax("项目账号绑定关系列表",t,function(t,a){e.dataListLoading=!1,e.loadingBtnState.searchState=!1,null===t?e.$message({message:a.msg,type:"error"}):(e.dataList=t.data.result,e.dataCount=t.data.count)})},resetForm:function(e){switch(this.$refs[e].resetFields(),e){case"addform":case"editform":this.accountData=[]}},confirmClose:function(e){this.$confirm("确定要关闭弹出框吗?").then(function(t){e()}).catch(function(e){})},addBefore:function(){this.addFormVisible=!0},selectUser:function(){var e=!1;return this.addform.userid||(this.$message({type:"warning",message:"请点击表格,选择一个账号!"}),e=!0),e},searchUser:function(){this.$refs.addform.validate()},addHandle:function(){var e=this;this.$refs.addform.validate(function(t){if(!t)return!1;e.selectUser()||(e.loadingBtnState.addState=!0,e.ajax("添加项目账号绑定关系",e.addform,function(t,a){e.loadingBtnState.addState=!1,null===t?e.$message({message:a.msg,type:"error"}):(e.addFormVisible=!1,e.$message({type:"success",message:"添加成功!"}),e.getDataList(),e.resetForm("addform"))}))})},editBefore:function(e,t){this.activeIndex=t,this.editform.username=e.UserName,this.editform.userid=e.UserID,this.editform.prjids=[];var a=!0,r=!1,i=void 0;try{for(var s,n=o()(e.PrjID.split(","));!(a=(s=n.next()).done);a=!0){var l=s.value;this.editform.prjids.push(parseInt(l))}}catch(e){r=!0,i=e}finally{try{!a&&n.return&&n.return()}finally{if(r)throw i}}this.editFormVisible=!0},noChange:function(){var e=this.dataList[this.activeIndex],t=this.editform;return e.PrjID===t.prjids.toString()&&(this.resetForm("editform"),this.activeIndex="",this.editFormVisible=!1,!0)},editHandle:function(){var e=this;this.$refs.editform.validate(function(t){if(!t)return!1;e.noChange()||(e.loadingBtnState.editState=!0,e.ajax("修改项目账号绑定关系",e.editform,function(t,a){e.loadingBtnState.editState=!1,null===t?e.$message({message:a.msg,type:"error"}):(e.editFormVisible=!1,e.activeIndex="",e.$message({type:"success",message:"修改成功!"}),e.getDataList(),e.resetForm("editform"))}))})},remove:function(e,t){var a=this;this.$confirm("确定要删除绑定吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.ajax("删除项目账号绑定关系",{userid:e.UserID},function(e,t){null===e?a.$message({message:t.msg,type:"error"}):(a.$message({type:"success",message:"删除成功!"}),a.getDataList())})}).catch(function(e){"cancel"!==e&&a.$message({type:"error",message:"系统错误,请联系管理员!"+e})})}},computed:{tableData:function(){var e=[],t=!0,a=!1,r=void 0;try{for(var s,l=o()(this.dataList);!(t=(s=l.next()).done);t=!0){var d=s.value,c=i()({},d);c.CreateTimeStr=n(c.CreateTime),c.buttons=[{type:"primary",icon:"el-icon-edit",title:"修改项目账号绑定关系",text:"编辑",fun:"editBefore"},{type:"danger",icon:"el-icon-delete",title:"删除项目账号绑定关系",text:"删除",fun:"remove"}],e.push(c)}}catch(e){a=!0,r=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw r}}return e}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"border pd10"},[a("el-row",[a("el-col",{staticClass:"pd10"},[a("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.form,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"账号"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"prjid"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.prjid,callback:function(t){e.$set(e.form,"prjid",t)},expression:"form.prjid"}},e._l(e.projectList,function(e){return a("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.loadingBtnState.searchState},on:{click:e.getDataList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.resetForm("form")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"pd10",attrs:{span:24}},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.addBefore}},[e._v("添加")])],1)],1),e._v(" "),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}]},[a("el-col",{staticClass:"pd10",attrs:{span:24}},[a("my-table",{attrs:{tableFormat:e.tableFormat,data:e.tableData,options:e.options},on:{editBefore:e.editBefore,remove:e.remove}}),e._v(" "),a("el-pagination",{attrs:{align:"center",background:"","current-page":e.pageindex,"page-size":e.pagesize,layout:"total, prev, pager, next",total:e.dataCount},on:{"current-change":e.currentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加项目账号绑定关系",visible:e.addFormVisible,"before-close":e.confirmClose},on:{"update:visible":function(t){e.addFormVisible=t},close:function(t){e.resetForm("addform")}}},[a("el-form",{ref:"addform",attrs:{model:e.addform,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{attrs:{maxlength:"20",placeholder:"账号"},model:{value:e.addform.username,callback:function(t){e.$set(e.addform,"username",t)},expression:"addform.username"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.searchUser()}},slot:"append"})],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"calc(100% - 80px)","margin-left":"80px"},attrs:{data:e.accountData,"highlight-current-row":"","max-height":"200px"},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{property:"UserName",label:"账号"}}),e._v(" "),a("el-table-column",{attrs:{property:"Name",label:"姓名"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"prjids"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.addform.prjids,callback:function(t){e.$set(e.addform,"prjids",t)},expression:"addform.prjids"}},e._l(e.projectList,function(e){return a("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loadingBtnState.addState},on:{click:e.addHandle}},[e._v("保 存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改项目账号绑定关系",visible:e.editFormVisible,"before-close":e.confirmClose},on:{"update:visible":function(t){e.editFormVisible=t},close:function(t){e.resetForm("editform")}}},[a("el-form",{ref:"editform",attrs:{model:e.editform,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"账号"}},[a("span",[e._v(e._s(e.editform.username))])]),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"prjids"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.editform.prjids,callback:function(t){e.$set(e.editform,"prjids",t)},expression:"editform.prjids"}},e._l(e.projectList,function(e){return a("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loadingBtnState.editState},on:{click:e.editHandle}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,d,!1,function(e){a("lUQH")},"data-v-00fceed6",null);t.default=c.exports},Dd8w:function(e,t,a){"use strict";t.__esModule=!0;var r,i=a("woOf"),s=(r=i)&&r.__esModule?r:{default:r};t.default=s.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}},R4wc:function(e,t,a){var r=a("kM2E");r(r.S+r.F,"Object",{assign:a("To3L")})},To3L:function(e,t,a){"use strict";var r=a("lktj"),i=a("1kS7"),s=a("NpIQ"),o=a("sB3e"),n=a("MU5D"),l=Object.assign;e.exports=!l||a("S82l")(function(){var e={},t={},a=Symbol(),r="abcdefghijklmnopqrst";return e[a]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[a]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var a=o(e),l=arguments.length,d=1,c=i.f,m=s.f;l>d;)for(var u,f=n(arguments[d++]),p=c?r(f).concat(c(f)):r(f),g=p.length,h=0;g>h;)m.call(f,u=p[h++])&&(a[u]=f[u]);return a}:l},V3tA:function(e,t,a){a("R4wc"),e.exports=a("FeBl").Object.assign},lUQH:function(e,t){},woOf:function(e,t,a){e.exports={default:a("V3tA"),__esModule:!0}}});