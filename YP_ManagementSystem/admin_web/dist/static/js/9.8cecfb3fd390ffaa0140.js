webpackJsonp([9],{Dd8w:function(t,e,i){"use strict";e.__esModule=!0;var r,a=i("woOf"),o=(r=a)&&r.__esModule?r:{default:r};e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}},F3n7:function(t,e){},R4wc:function(t,e,i){var r=i("kM2E");r(r.S+r.F,"Object",{assign:i("To3L")})},To3L:function(t,e,i){"use strict";var r=i("lktj"),a=i("1kS7"),o=i("NpIQ"),s=i("sB3e"),n=i("MU5D"),l=Object.assign;t.exports=!l||i("S82l")(function(){var t={},e={},i=Symbol(),r="abcdefghijklmnopqrst";return t[i]=7,r.split("").forEach(function(t){e[t]=t}),7!=l({},t)[i]||Object.keys(l({},e)).join("")!=r})?function(t,e){for(var i=s(t),l=arguments.length,d=1,c=a.f,f=o.f;l>d;)for(var m,u=n(arguments[d++]),g=c?r(u).concat(c(u)):r(u),p=g.length,h=0;p>h;)f.call(u,m=g[h++])&&(i[m]=u[m]);return i}:l},V3tA:function(t,e,i){i("R4wc"),t.exports=i("FeBl").Object.assign},hsQG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("Dd8w"),a=i.n(r),o=i("BO1k"),s=i.n(o),n=Vue.filter("formatDate"),l={data:function(){return{tableFormat:[{prop:"OrgName",label:"组织名称",width:"150"},{prop:"PrjName",label:"项目名称"},{prop:"CreateTimeStr",label:"创建时间",width:"180"}],options:{button:!0,buttonText:!0,maxButtons:2},dataList:[],dataCount:0,pageindex:1,pagesize:10,projectList:[],projectValidityList:[],orgList:[],orgValidityList:[],dataListLoading:!1,addFormVisible:!1,editFormVisible:!1,form:{orgid:"",prjid:""},addform:{orgid:"",prjid:""},editform:{id:"",orgid:"",prjid:""},activeIndex:"",rules:{orgid:[{required:!0,message:"请选择所属组织",trigger:"change"}],prjid:[{required:!0,message:"请选择项目",trigger:"change"}]},loadingBtnState:{searchState:!1,addState:!1,editState:!1}}},created:function(){this.init()},methods:{init:function(){this.getDataList(),this.getProjectList(),this.getOrgList()},getProjectList:function(){var t=this;this.ajax("组织绑定页所有项目",{},function(e,i){null===e?t.$message({message:i.msg,type:"error"}):t.projectList=e.data})},getValidityProject:function(){var t=this;this.ajax("组织绑定页有效项目",{},function(e,i){if(null===e)t.$message({message:i.msg,type:"error"});else if(t.projectValidityList=e.data,t.editform.prjid){var r=!0,a=!1,o=void 0;try{for(var n,l=s()(t.projectList);!(r=(n=l.next()).done);r=!0){var d=n.value;d.ID===t.editform.prjid&&t.projectValidityList.push({ID:d.ID,Name:d.Name})}}catch(i){a=!0,o=i}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}}})},getValidityOrg:function(){var t=this;this.ajax("获取有效组织",{},function(e,i){if(null===e)t.$message({message:i.msg,type:"error"});else if(t.orgValidityList=e.data,console.log(!!t.editform.orgid,t.editform.orgid),t.editform.orgid){var r=!0,a=!1,o=void 0;try{for(var n,l=s()(t.orgList);!(r=(n=l.next()).done);r=!0){var d=n.value;d.ID===t.editform.orgid&&t.orgValidityList.push({ID:d.ID,Name:d.Name})}}catch(i){a=!0,o=i}finally{try{!r&&l.return&&l.return()}finally{if(a)throw o}}}})},getOrgList:function(){var t=this;this.ajax("所有组织",{},function(e,i){null===e?t.$message({message:i.msg,type:"error"}):t.orgList=e.data})},currentChange:function(t){this.pageindex=t||1,this.getDataList()},getDataList:function(){var t=this;this.dataListLoading=!0,this.loadingBtnState.searchState=!0;var e={start:(this.pageindex-1)*this.pagesize,size:this.pagesize};for(var i in this.form)""!==this.form[i]&&(e[i]=this.form[i]);this.ajax("项目组织绑定关系列表",e,function(e,i){t.dataListLoading=!1,t.loadingBtnState.searchState=!1,null===e?t.$message({message:i.msg,type:"error"}):(t.dataList=e.data.result,t.dataCount=e.data.count)})},resetForm:function(t){this.$refs[t].resetFields(),"editform"===t&&(this.editform.id="",this.editform.orgid="",this.editform.prjid="")},addBefore:function(){this.getValidityProject(),this.getValidityOrg(),this.addFormVisible=!0},addHandle:function(){var t=this;this.$refs.addform.validate(function(e){if(!e)return!1;t.loadingBtnState.addState=!0,t.ajax("添加项目组织绑定关系",t.addform,function(e,i){t.loadingBtnState.addState=!1,null===e?t.$message({message:i.msg,type:"error"}):(t.addFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.getDataList())})})},editBefore:function(t,e){this.activeIndex=e,this.editform.id=t.ID,this.editform.orgid=t.OrgID,this.editform.prjid=t.PrjID,this.getValidityProject(),this.getValidityOrg(),this.editFormVisible=!0},noChange:function(){var t=this.dataList[this.activeIndex],e=this.editform;return t.OrgID===e.orgid&&t.PrjID===e.prjid&&(this.resetForm("editform"),this.activeIndex="",this.editFormVisible=!1,!0)},editHandle:function(){var t=this;this.$refs.editform.validate(function(e){if(!e)return!1;t.noChange()||(t.loadingBtnState.editState=!0,t.ajax("修改项目组织绑定关系",t.editform,function(e,i){t.loadingBtnState.editState=!1,null===e?t.$message({message:i.msg,type:"error"}):(t.editFormVisible=!1,t.resetForm("editform"),t.activeIndex="",t.$message({type:"success",message:"修改成功!"}),t.getDataList())}))})},remove:function(t,e){var i=this;console.log(111),this.$confirm("确定要删除绑定吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.ajax("删除项目组织绑定关系",{id:t.ID},function(t,e){null===t?i.$message({message:e.msg,type:"error"}):(i.$message({type:"success",message:"删除成功!"}),i.getDataList())})}).catch(function(t){"cancel"!==t&&i.$message({type:"error",message:"系统错误,请联系管理员!"+t})})}},computed:{tableData:function(){var t=[],e=!0,i=!1,r=void 0;try{for(var o,l=s()(this.dataList);!(e=(o=l.next()).done);e=!0){var d=o.value,c=a()({},d);c.CreateTimeStr=n(c.CreateTime),c.buttons=[{type:"primary",icon:"el-icon-edit",title:"修改项目组织绑定关系",text:"编辑",fun:"editBefore"},{type:"danger",icon:"el-icon-delete",title:"删除项目组织绑定关系",text:"删除",fun:"remove"}],t.push(c)}}catch(t){i=!0,r=t}finally{try{!e&&l.return&&l.return()}finally{if(i)throw r}}return t}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"border pd10"},[i("el-row",[i("el-col",{staticClass:"pd10"},[i("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.form,"label-width":"70px"}},[i("el-form-item",{attrs:{label:"所属组织",prop:"orgid"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.orgid,callback:function(e){t.$set(t.form,"orgid",e)},expression:"form.orgid"}},t._l(t.orgList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"项目名称",prop:"prjid"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.prjid,callback:function(e){t.$set(t.form,"prjid",e)},expression:"form.prjid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",loading:t.loadingBtnState.searchState},on:{click:t.getDataList}},[t._v("查询")]),t._v(" "),i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.resetForm("form")}}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{staticClass:"pd10",attrs:{span:24}},[i("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:t.addBefore}},[t._v("添加")])],1)],1),t._v(" "),i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}]},[i("el-col",{staticClass:"pd10",attrs:{span:24}},[i("my-table",{attrs:{tableFormat:t.tableFormat,data:t.tableData,options:t.options},on:{editBefore:t.editBefore,remove:t.remove}}),t._v(" "),i("el-pagination",{attrs:{align:"center",background:"","current-page":t.pageindex,"page-size":t.pagesize,layout:"total, prev, pager, next",total:t.dataCount},on:{"current-change":t.currentChange}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"添加项目组织绑定关系",visible:t.addFormVisible},on:{"update:visible":function(e){t.addFormVisible=e},close:function(e){t.resetForm("addform")}}},[i("el-form",{ref:"addform",attrs:{model:t.addform,rules:t.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"所属组织",prop:"orgid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属组织"},on:{change:t.getRoleByOrgID},model:{value:t.addform.orgid,callback:function(e){t.$set(t.addform,"orgid",e)},expression:"addform.orgid"}},t._l(t.orgValidityList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"项目名称",prop:"prjid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.addform.prjid,callback:function(e){t.$set(t.addform,"prjid",e)},expression:"addform.prjid"}},t._l(t.projectValidityList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.addFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loadingBtnState.addState},on:{click:t.addHandle}},[t._v("保 存")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改项目组织绑定关系",visible:t.editFormVisible},on:{"update:visible":function(e){t.editFormVisible=e},close:function(e){t.resetForm("editform")}}},[i("el-form",{ref:"editform",attrs:{model:t.editform,rules:t.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"所属组织",prop:"orgid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属组织"},on:{change:t.getRoleByOrgID},model:{value:t.editform.orgid,callback:function(e){t.$set(t.editform,"orgid",e)},expression:"editform.orgid"}},t._l(t.orgValidityList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"项目名称",prop:"prjid"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.editform.prjid,callback:function(e){t.$set(t.editform,"prjid",e)},expression:"editform.prjid"}},t._l(t.projectValidityList,function(t){return i("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loadingBtnState.editState},on:{click:t.editHandle}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var c=i("VU/8")(l,d,!1,function(t){i("F3n7")},"data-v-6a36f790",null);e.default=c.exports},woOf:function(t,e,i){t.exports={default:i("V3tA"),__esModule:!0}}});