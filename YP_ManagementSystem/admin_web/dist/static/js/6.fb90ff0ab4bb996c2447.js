webpackJsonp([6],{"2uKk":function(e,t){},Dd8w:function(e,t,a){"use strict";t.__esModule=!0;var o,n=a("woOf"),r=(o=n)&&o.__esModule?o:{default:o};t.default=r.default||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}},Jg62:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("BO1k"),n=a.n(o),r=a("Dd8w"),i=a.n(r),l={components:{"tree-table":a("n9BG").a},data:function(){return{tableFormat:[{label:"标题",prop:"Title"},{label:"编码",prop:"ID",width:"50px"},{label:"内容",prop:"Content",html:!0}],tableData:[],tableDataList:[],options:{open:!1,tableCache:[],search:!1},rowData:{},activeIndex:"",formLabelWidth:"120px",knowledgeDetailForm:{ID:"",title:"",parentTitle:"",content:"",speechTechnique:"",copyState:""},searchForm:{prjid:"",context:"",code:""},loading:!1,approvalDialog:!1,approvalForm:{ID:"",title:"",parentTitle:"",content:"",speechTechnique:"",copyState:""},maxWordCount:{content:2e3,speechTechnique:500},surplusWordCount:{content:2e3,speechTechnique:500},approvalFormRules:{title:[{required:!0,message:"标题不可为空",trigger:"blur"},{min:0,max:50,message:"权限名称不要超过 50 个字符",trigger:"blur"}],content:[{min:0,max:2e3,message:"内容不要超过 2000 个字符",trigger:"blur"}],speechTechnique:[{min:0,max:500,message:"话术不要超过 500 个字符",trigger:"blur"}]},btnState:!0,loadingBtnState:{searchState:!1,addOrUpdateState:!1},projectData:[],developKnowledgeSummary:{success:0,fail:0,ready:0}}},methods:{init:function(){this.paramFormat()},rowClick:function(e){this.rowData=e,this.rowData?this.btnState=!1:(this.btnState=!0,this.resetForm("knowledgeDetailForm"));var t=this;this.knowledgeDetail(function(e,a){null===e?t.$message({message:a.msg,type:"error"}):(t.knowledgeDetailForm.ID=e.data.ID,t.knowledgeDetailForm.title=e.data.Title,t.knowledgeDetailForm.content=e.data.Content,t.knowledgeDetailForm.speechTechnique=e.data.Verbal,t.knowledgeDetailForm.copyState=0!==e.data.IsCopy)})},resetForm:function(e){this.$refs[e].resetFields()},paramFormat:function(e){this.searchForm.code.length>0?(this.options.search="code",e="search"):this.searchForm.context.length>0?(this.options.search="content",e="search"):this.options.search=!1,this.loadingBtnState.searchState=!0;var t={};for(var a in this.searchForm)""!==this.searchForm[a]&&(t[a]=this.searchForm[a]);var o=i()({},t);this.searchForm.context.length>0?this.options.open=!0:this.options.open=!1,this.getKnowledgeData(o,e)},getKnowledgeData:function(e,t){var a=this;this.ajax("知识库展示页列表",e,function(e,o){if(a.loadingBtnState.searchState=!1,null===e)a.$message({message:o.msg,type:"error"});else if(a.tableDataList=[],"search"===t&&(a.searchForm.context.length>0||a.searchForm.code.length>0)){var r=!0,i=!1,l=void 0;try{for(var s,c=n()(e.data);!(r=(s=c.next()).done);r=!0){var p=s.value;p.IsLeaf="code"!=a.options.search&&1==!p.IsLeaf,a.tableDataList.push(p)}}catch(o){i=!0,l=o}finally{try{!r&&c.return&&c.return()}finally{if(i)throw l}}}else{var d=!0,u=!1,h=void 0;try{for(var m,f=n()(e.data);!(d=(m=f.next()).done);d=!0){var v=m.value;v._level=0,v._expanded=!1,v._show=!0,v.IsLeaf=1==!v.IsLeaf,v.isClick=!1,a.tableDataList.push(v)}}catch(o){u=!0,h=o}finally{try{!d&&f.return&&f.return()}finally{if(u)throw h}}}})},getKbListByPId:function(e,t,a){this.activeIndex=t;var o=this;this.getKnowledgeDataByPid({pid:e.ID},function(e,n){o.loadingBtnState.searchState=!1,null===e?o.$message({message:n.msg,type:"error"}):(o.options.tableCache=o.MergeArray(a,e.data),e.data.length<1&&(o.options.tableCache[t].isChild=!1),o.tableDataList=o.options.tableCache)})},getKnowledgeDataByPid:function(e,t){this.ajax("知识库获取子节点数据",e,t)},MergeArray:function(e,t){for(var a=new Array,o=0;o<e.length;o++)a.push(e[o]);for(var n=0;n<t.length;n++){for(var r=!0,i=0;i<e.length;i++)if(t[n].ID==e[i].ID){r=!1;break}r&&(t[n].IsLeaf=1==!t[n].IsLeaf,a.push(t[n]))}return a},descInput:function(e){var t=this.maxWordCount[e],a=this.approvalForm[e].length;this.surplusWordCount[e]=parseInt(t)-parseInt(a)},addActionBefore:function(){this.descInput("speechTechnique"),this.descInput("content"),this.rowData?(this.approvalForm.parentTitle=this.rowData.Title,this.approvalDialog=!0):this.$message({message:"未找到选中节点，请刷新重新操作",type:"error"})},addOrUpdateAction:function(){var e=this;this.$refs.approvalForm.validate(function(t){if(!t)return!1;if(e.rowData){var a={};a.prjid=e.searchForm.prjid,a.pid=e.rowData.ID,a.title=e.approvalForm.title,a.content=e.approvalForm.content,a.verbal=e.approvalForm.speechTechnique,e.loadingBtnState.addOrUpdateState=!0,e.addKnowledge(a)}else e.$message({message:"未找到选中节点，请刷新重新操作",type:"error"})})},addKnowledge:function(e){var t=this;t.ajax("预知识新增",e,function(e,a){t.loadingBtnState.addOrUpdateState=!1,null===e?t.$message({message:a.msg,type:"error"}):(t.addOrUpdateDialog=!1,t.$message({type:"success",message:"操作成功"}),t.approvalDialog=!1)})},knowledgeDetail:function(e){this.rowData&&this.ajax("知识库展示页详情",{id:this.rowData.ID},e)},getKnowledgePrijectData:function(){var e=this;this.ajax("知识库展示页项目列表",{},function(t,a){if(null===t)e.$message({message:a.msg,type:"error"});else{if(t.data.length<1)return void e.$message({message:"当前账号未配置项目，请先配置项目",type:"warning"});e.projectData=t.data,e.searchForm.prjid=t.data[0].ID,e.init()}})},getSummary:function(){var e=this;this.ajax("知识库展示页预知识汇总",{},function(t,a){null===t?e.$message({message:a.msg,type:"error"}):(e.developKnowledgeSummary.success=t.data.passCount||0,e.developKnowledgeSummary.fail=t.data.rejCount||0,e.developKnowledgeSummary.ready=t.data.sumCount-(t.data.passCount+t.data.rejCount)||0)})},myReplace:function(e,t,a){var o=new RegExp(t,"g");return e.replace(o,a)},copyAction:function(){var e=document.createElement("input");e.value=this.knowledgeDetailForm.speechTechnique,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$message({message:"复制成功",type:"success"})},enjoinAction:function(){var e=document.createElement("input");e.value="亲,禁止复制哦",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$message({message:"禁止复制",type:"warning"})},dialogClose:function(){var e=this;this.$confirm("关闭内容将不会保存，确认关闭？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.approvalDialog=!1,resetForm("approvalForm")}).catch(function(){})}},created:function(){this.getKnowledgePrijectData(),this.getSummary()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{gutter:20}},[a("el-col",{staticClass:"left",attrs:{span:16}},[a("div",{staticClass:"border pd10"},[a("el-row",[a("el-col",{staticClass:"pd10",attrs:{span:24}},[a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[a("el-form-item",{attrs:{label:"项目 :"}},[a("el-select",{attrs:{size:"mini",placeholder:"---请选择---"},model:{value:e.searchForm.prjid,callback:function(t){e.$set(e.searchForm,"prjid",t)},expression:"searchForm.prjid"}},e._l(e.projectData,function(e){return a("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"内容 :",prop:"context"}},[a("el-input",{attrs:{size:"mini",placeholder:"内容模糊检索",maxlength:50},model:{value:e.searchForm.context,callback:function(t){e.$set(e.searchForm,"context",t)},expression:"searchForm.context"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编码 :",prop:"code"}},[a("el-input",{attrs:{size:"mini",placeholder:"编码精确查找",maxlength:20},model:{value:e.searchForm.code,callback:function(t){e.$set(e.searchForm,"code",t)},expression:"searchForm.code"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini",loading:e.loadingBtnState.searchState},on:{click:function(t){e.paramFormat("search")}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.resetForm("searchForm")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"pd10"},[a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"small",disabled:e.btnState},on:{click:function(t){e.addActionBefore()}}},[e._v("预知识添加")])],1),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-tag",{attrs:{type:"danger"}},[e._v("未通过："+e._s(e.developKnowledgeSummary.fail))]),e._v(" "),a("el-tag",{attrs:{type:"warning"}},[e._v("待审核："+e._s(e.developKnowledgeSummary.ready))]),e._v(" "),a("el-tag",{attrs:{type:"success"}},[e._v("已通过："+e._s(e.developKnowledgeSummary.success))])],1)],1),e._v(" "),a("tree-table",{attrs:{tableFormat:e.tableFormat,data:e.tableDataList,options:e.options},on:{rowClick:e.rowClick,getKbListByPId:e.getKbListByPId}})],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"border"},[a("div",{staticClass:"right",staticStyle:{height:"100%"}},[a("el-form",{ref:"knowledgeDetailForm",attrs:{model:e.knowledgeDetailForm,"label-position":"left"}},[a("el-form-item",{attrs:{label:"标题 :","label-width":e.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{readonly:!0,"auto-complete":"off"},model:{value:e.knowledgeDetailForm.title,callback:function(t){e.$set(e.knowledgeDetailForm,"title",t)},expression:"knowledgeDetailForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容 :","label-width":e.formLabelWidth,prop:"content"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:16},readonly:!0},nativeOn:{copy:function(t){return e.enjoinAction(t)}},model:{value:e.knowledgeDetailForm.content,callback:function(t){e.$set(e.knowledgeDetailForm,"content",t)},expression:"knowledgeDetailForm.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"话术是否可复制 :","label-width":e.formLabelWidth,prop:"copyState"}},[a("el-switch",{attrs:{disabled:!0},model:{value:e.knowledgeDetailForm.copyState,callback:function(t){e.$set(e.knowledgeDetailForm,"copyState",t)},expression:"knowledgeDetailForm.copyState"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"话术 :","label-width":e.formLabelWidth,prop:"speechTechnique"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:12},readonly:!0},nativeOn:{copy:function(t){return e.enjoinAction(t)}},model:{value:e.knowledgeDetailForm.speechTechnique,callback:function(t){e.$set(e.knowledgeDetailForm,"speechTechnique",t)},expression:"knowledgeDetailForm.speechTechnique"}}),e._v(" "),a("br"),e._v(" "),e.knowledgeDetailForm.copyState?a("span",{staticClass:"text",staticStyle:{float:"right",color:"#909399"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-printer",size:"mini"},on:{click:e.copyAction}},[e._v("复制")])],1):e._e()],1)],1)],1)])])],1),e._v(" "),a("el-dialog",{attrs:{title:"预知识新增",visible:e.approvalDialog,"before-close":e.dialogClose,"close-on-click-modal":!1},on:{"update:visible":function(t){e.approvalDialog=t},close:function(t){e.resetForm("approvalForm")}}},[a("el-form",{ref:"approvalForm",attrs:{model:e.approvalForm,rules:e.approvalFormRules}},[a("el-form-item",{attrs:{label:"标题 :","label-width":e.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.approvalForm.title,callback:function(t){e.$set(e.approvalForm,"title",t)},expression:"approvalForm.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上级标题 :","label-width":e.formLabelWidth,prop:"parentTitle"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:e.approvalForm.parentTitle,callback:function(t){e.$set(e.approvalForm,"parentTitle",t)},expression:"approvalForm.parentTitle"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容 :","label-width":e.formLabelWidth,prop:"content"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},on:{input:function(t){e.descInput("content")}},model:{value:e.approvalForm.content,callback:function(t){e.$set(e.approvalForm,"content",t)},expression:"approvalForm.content"}}),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"text",staticStyle:{float:"right",color:"#909399","margin-right":"55px"}},[e._v("剩余"+e._s(e.surplusWordCount.content)+"字")])],1),e._v(" "),a("el-form-item",{attrs:{label:"话术 :","label-width":e.formLabelWidth,prop:"speechTechnique"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},on:{input:function(t){e.descInput("speechTechnique")}},model:{value:e.approvalForm.speechTechnique,callback:function(t){e.$set(e.approvalForm,"speechTechnique",t)},expression:"approvalForm.speechTechnique"}}),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"text",staticStyle:{float:"right",color:"#909399","margin-right":"55px"}},[e._v("剩余"+e._s(e.surplusWordCount.speechTechnique)+"字")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.dialogClose}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loadingBtnState.addOrUpdateState},on:{click:e.addOrUpdateAction}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,s,!1,function(e){a("jaTz")},"data-v-94f5d530",null);t.default=c.exports},R4wc:function(e,t,a){var o=a("kM2E");o(o.S+o.F,"Object",{assign:a("To3L")})},To3L:function(e,t,a){"use strict";var o=a("lktj"),n=a("1kS7"),r=a("NpIQ"),i=a("sB3e"),l=a("MU5D"),s=Object.assign;e.exports=!s||a("S82l")(function(){var e={},t={},a=Symbol(),o="abcdefghijklmnopqrst";return e[a]=7,o.split("").forEach(function(e){t[e]=e}),7!=s({},e)[a]||Object.keys(s({},t)).join("")!=o})?function(e,t){for(var a=i(e),s=arguments.length,c=1,p=n.f,d=r.f;s>c;)for(var u,h=l(arguments[c++]),m=p?o(h).concat(p(h)):o(h),f=m.length,v=0;f>v;)d.call(h,u=m[v++])&&(a[u]=h[u]);return a}:s},V3tA:function(e,t,a){a("R4wc"),e.exports=a("FeBl").Object.assign},jaTz:function(e,t){},n9BG:function(e,t,a){"use strict";var o=a("Dd8w"),n=a.n(o),r=a("BO1k"),i=a.n(r),l={props:{tableFormat:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return{}}},show:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{tableData:function(){var e=[],t=!0,a=!1,o=void 0;try{for(var r,l=i()(this.data);!(t=(r=l.next()).done);t=!0){var s=r.value,c=n()({},s);e.push(c)}}catch(e){a=!0,o=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw o}}var p=[];return p="code"==this.options.search?e:this.formatTreeTable(e,0,0,null,this.options.open),this.options.tableCache=p,p}},methods:{fun:function(e,t,a){this.$emit(e,t,a)},rowClick:function(e){this.$emit("rowClick",e)},tableRowClassName:function(e){var t=e.row,a=e.rowIndex;t.index=a},handleSelectionChange:function(e){if(this.options.selection){var t=[],a=[];for(var o in e)for(var n in t.push(e[o].ID),this.data)this.data[n].ID===e[o].ID&&a.push(n);this.options.multipleSelectionIndex=a,this.options.multipleSelection=t}},showTr:function(e,t){e.row.ID;var a=e.row,o=!a._parent||a._parent._expanded&&a._parent._show;return a._show=o,o?"":"display:none;"},toggle:function(e,t){var a=!this.tableData[t]._expanded;this.$set(this.tableData[t],"_expanded",a),this.$set(this.options.tableCache[t],"_expanded",a),a&&!e.isClick&&"content"!=this.options.search&&(this.$set(this.options.tableCache[t],"isClick",!0),this.$emit("getKbListByPId",e,t,this.options.tableCache))},formatTreeTable:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=[],l=!0,s=!1,c=void 0;try{for(var p,d=i()(e);!(l=(p=d.next()).done);l=!0){var u=p.value;if(u.Pid===t){u._level=a,u._expanded=n||void 0!==u._expanded&&u._expanded,null===o?u._show=!0:(o.isparent=!0,u._show=n||void 0!==u._show&&u._show,u._parent=o),r.push(u);var h=this.formatTreeTable(e,u.ID,a+1,u,this.options.open);r=r.concat(h)}}}catch(e){s=!0,c=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw c}}return r}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.tableData,"tooltip-effect":"dark",border:"","highlight-current-row":"","max-height":"600",size:"mini","row-style":e.showTr,"row-class-name":e.tableRowClassName},on:{"selection-change":e.handleSelectionChange,"current-change":e.rowClick}},[e.options.selection?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),e._l(e.tableFormat,function(t,o){return[0===o?a("el-table-column",{attrs:{label:t.label,width:t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{style:"text-indent:"+(t.row._level+1)+"em;position:relative"},[t.row.IsLeaf?[t.row._expanded?a("i",{staticClass:"el-icon-arrow-down expanded-icon",on:{click:function(a){e.toggle(t.row,t.$index)}}}):a("i",{staticClass:"el-icon-arrow-right expanded-icon",on:{click:function(a){e.toggle(t.row,t.$index)}}})]:e._e(),e._v(" "),a("span",{domProps:{innerHTML:e._s(t.row.Title)}})],2)]}}])}):t.html?a("el-table-column",{attrs:{label:t.label,width:t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(o){return[a("div",{domProps:{innerHTML:e._s(o.row[t.prop])}})]}}])}):a("el-table-column",{attrs:{prop:t.prop,label:t.label,width:t.width,"show-overflow-tooltip":""}})]}),e._v(" "),e.options.button?a("el-table-column",{attrs:{label:"操作",width:72*e.options.maxButtons,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[e._l(t.row.buttons,function(o){return[o.show?[e.show[o.show]?a("el-button",{attrs:{type:o.type,icon:o.icon,title:o.title},on:{click:function(a){e.fun(o.fun,t.row,t.$index)}}}):e._e()]:[a("el-button",{attrs:{type:o.type,icon:o.icon,title:o.title},on:{click:function(a){e.fun(o.fun,t.row,t.$index)}}})]]})],2)]}}])}):e._e()],2)],1)},staticRenderFns:[]};var c=a("VU/8")(l,s,!1,function(e){a("2uKk")},"data-v-0482d2c4",null);t.a=c.exports},woOf:function(e,t,a){e.exports={default:a("V3tA"),__esModule:!0}}});