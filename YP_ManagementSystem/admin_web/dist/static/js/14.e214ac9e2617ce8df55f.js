webpackJsonp([14],{Dd8w:function(t,e,a){"use strict";e.__esModule=!0;var r,o=a("woOf"),l=(r=o)&&r.__esModule?r:{default:r};e.default=l.default||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t}},R4wc:function(t,e,a){var r=a("kM2E");r(r.S+r.F,"Object",{assign:a("To3L")})},To3L:function(t,e,a){"use strict";var r=a("lktj"),o=a("1kS7"),l=a("NpIQ"),i=a("sB3e"),s=a("MU5D"),n=Object.assign;t.exports=!n||a("S82l")(function(){var t={},e={},a=Symbol(),r="abcdefghijklmnopqrst";return t[a]=7,r.split("").forEach(function(t){e[t]=t}),7!=n({},t)[a]||Object.keys(n({},e)).join("")!=r})?function(t,e){for(var a=i(t),n=arguments.length,p=1,c=o.f,m=l.f;n>p;)for(var u,d=s(arguments[p++]),v=c?r(d).concat(c(d)):r(d),h=v.length,f=0;h>f;)m.call(d,u=v[f++])&&(a[u]=d[u]);return a}:n},V3tA:function(t,e,a){a("R4wc"),t.exports=a("FeBl").Object.assign},"dX/q":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("BO1k"),o=a.n(r),l=a("woOf"),i=a.n(l),s=a("Dd8w"),n=a.n(s),p=Vue.filter("formatDate"),c=Vue.filter("formApprovalState"),m={data:function(){return{tableFormat:[{label:"项目名称",prop:"projectName"},{label:"员工账号",prop:"UserName"},{label:"员工姓名",prop:"Name"},{label:"添加时间",prop:"CreateTime"},{label:"审核时间",prop:"AuditTime"},{label:"审核状态",prop:"Status"},{label:"审核人",prop:"Auditor"}],options:{selection:!1,multipleSelection:[],multipleSelectionIndex:[],button:!0,buttonText:!0,maxButtons:2},show:{"预知识审核":!0,"预知识详情":!0},loadingBtnState:{searchState:!1,approvalState:!1},pageindex:1,pagesize:20,pageTotal:0,developKnowledgeData:[],projectData:[],searchForm:{prjid:"",creator:"",status:"",createtimestart:"",createtimeend:"",audittimestart:"",audittimeend:"",createEnd:"",approvalEnd:""},formLabelWidth:"120px",approvalDialog:!1,activeObject:{},approvalForm:{ID:"",title:"",parentTitle:"",content:"",speechTechnique:"",copyState:""},maxWordCount:{content:2e3,speechTechnique:500},surplusWordCount:{content:2e3,speechTechnique:500},approvalFormRules:{title:[{required:!0,message:"标题不可为空",trigger:"blur"},{min:0,max:50,message:"权限名称不要超过 50 个字符",trigger:"blur"}],content:[{min:0,max:2e3,message:"内容不要超过 2000 个字符",trigger:"blur"}],speechTechnique:[{min:0,max:500,message:"话术不要超过 500 个字符",trigger:"blur"}]},detailDialog:!1,approvalState:[]}},methods:{init:function(){var t=this;this.getDic("预知识审核状态",function(e){t.approvalState=e}),this.getPrijectData(),this.paramFormat()},getPrijectData:function(){var t=this;this.ajax("预知识项目列表",{},function(e,a){if(null===e)t.$message({message:a.msg,type:"error"});else{if(e.data.length<1)return void t.$message({message:"当前账号未配置项目，请先配置项目",type:"warning"});t.projectData=e.data}})},getDevelopKnowledgeData:function(t){var e=this;this.ajax("预知识列表",t,function(t,a){e.loadingBtnState.searchState=!1,null===t?e.$message({message:a.msg,type:"error"}):(e.developKnowledgeData=t.data.result,e.pageTotal=t.data.count)})},paramFormat:function(){this.loadingBtnState.searchState=!0,this.searchForm.createtimeend=this.searchForm.createEnd?moment(this.searchForm.createEnd).add(1,"days").format("YYYY-MM-DD"):"",this.searchForm.audittimeend=this.searchForm.approvalEnd?moment(this.searchForm.approvalEnd).add(1,"days").format("YYYY-MM-DD"):"";var t={};for(var e in this.searchForm)""!==this.searchForm[e]&&(t[e]=this.searchForm[e]);var a=n()({},t,{start:(this.pageindex-1)*this.pagesize,size:this.pagesize});this.getDevelopKnowledgeData(a)},resetForm:function(t){this.$refs[t].resetFields()},knowledgeDetail:function(t){var e=this;this.ajax("预知识详情",{id:t},function(t,a){null===t?e.$message({message:a.msg,type:"error"}):(e.approvalForm.title=t.data.Title,e.approvalForm.parentTitle=t.data.parentTitle,e.approvalForm.content=t.data.Content,e.approvalForm.speechTechnique=t.data.Verbal,e.approvalForm.copyState=0!==t.data.IsCopy,e.approvalForm.ID=t.data.ID,e.activeObject=i()({},e.approvalForm),e.descInput("content"),e.descInput("speechTechnique"))})},currentChange:function(t){this.pageindex=t||1,this.paramFormat()},isChange:function(){for(var t in this.approvalForm)if(this.activeObject[t]!=this.approvalForm[t])return!1;return!0},descInput:function(t){var e=this.maxWordCount[t],a=this.approvalForm[t].length;this.surplusWordCount[t]=parseInt(e)-parseInt(a)},approval:function(t,e){this.approvalDialog=!0,this.activeIndex=e,this.knowledgeDetail(t.ID)},approvalDetail:function(t,e){this.detailDialog=!0,this.activeIndex=e,this.knowledgeDetail(t.ID)},auditAction:function(t){var e=this;if(this.loadingBtnState.approvalState=!0,"reject"===t)this.$confirm("不通过后将无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e;e.approvalForm.ID?t.auditRejPre():t.$message({message:"未找到预知识，请刷新重新操作",type:"error"})}).catch(function(t){"cancel"!==t&&e.$message({type:"error",message:"系统错误,请联系管理员!"+t})});else{if(!this.approvalForm.ID)return void this.$message({message:"未找到预知识，请刷新重新操作",type:"error"});this.isChange()?this.auditPassPre():this.$confirm("是否保存所做的更改?","提示",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning"}).then(function(){e.updatePre()}).catch(function(t){e.approvalForm=i()({},e.activeObject),"cancel"!==t&&e.$message({type:"error",message:"系统错误,请联系管理员!"+t})})}},auditRejPre:function(){var t=this;t.ajax("预知识不通过",{id:this.approvalForm.ID},function(e,a){t.loadingBtnState.approvalState=!1,null===e?t.$message({message:a.msg,type:"error"}):(t.approvalDialog=!1,t.$message({type:"success",message:"操作成功"}),t.paramFormat())})},auditPassPre:function(){var t=this;t.ajax("预知识通过",{id:this.approvalForm.ID},function(e,a){t.loadingBtnState.approvalState=!1,null===e?t.$message({message:a.msg,type:"error"}):(t.approvalDialog=!1,t.$message({type:"success",message:"操作成功"}),t.paramFormat())})},updatePre:function(){var t={id:this.approvalForm.ID,title:this.approvalForm.title,content:this.approvalForm.content,verbal:this.approvalForm.speechTechnique,iscopy:this.approvalForm.copyState?1:0},e=this;e.ajax("预知识修改",t,function(t,a){null===t?e.$message({message:a.msg,type:"error"}):(e.approvalDialog=!1,e.auditPassPre())})}},created:function(){this.init()},computed:{tableData:function(){var t=[],e=!0,a=!1,r=void 0;try{for(var l,i=o()(this.developKnowledgeData);!(e=(l=i.next()).done);e=!0){var s=l.value,m=n()({},s);m.CreateTime=p(m.CreateTime),m.AuditTime=p(m.AuditTime),m.Status=c(m.Status),m.buttons=[],0===s.Status?m.buttons.push({show:"预知识审核",type:"primary",icon:"el-icon-edit-outline",title:"预知识审核",text:"审核",fun:"approval"}):m.buttons.push({show:"预知识详情",type:"primary",icon:"el-icon-tickets",title:"预知识详情",text:"详情",fun:"approvalDetail"}),t.push(m)}}catch(t){a=!0,r=t}finally{try{!e&&i.return&&i.return()}finally{if(a)throw r}}return t}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"border pd10"},[a("div",[a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.searchForm}},[a("el-form-item",{attrs:{label:"项目 :",prop:"prjid"}},[a("el-select",{attrs:{placeholder:"---请选择---"},model:{value:t.searchForm.prjid,callback:function(e){t.$set(t.searchForm,"prjid",e)},expression:"searchForm.prjid"}},t._l(t.projectData,function(t){return a("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"员工账号 :",prop:"creator"}},[a("el-input",{attrs:{placeholder:"员工账号",maxlength:50},model:{value:t.searchForm.creator,callback:function(e){t.$set(t.searchForm,"creator",e)},expression:"searchForm.creator"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"添加时间 :"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"createtimestart"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"开始时间",editable:!1,"value-format":"yyyy-MM-dd"},model:{value:t.searchForm.createtimestart,callback:function(e){t.$set(t.searchForm,"createtimestart",e)},expression:"searchForm.createtimestart"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:2}},[t._v("至")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"createEnd"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束时间",editable:!1,"value-format":"yyyy-MM-dd"},model:{value:t.searchForm.createEnd,callback:function(e){t.$set(t.searchForm,"createEnd",e)},expression:"searchForm.createEnd"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"审核时间 :"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"audittimestart"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"开始时间",editable:!1,"value-format":"yyyy-MM-dd"},model:{value:t.searchForm.audittimestart,callback:function(e){t.$set(t.searchForm,"audittimestart",e)},expression:"searchForm.audittimestart"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:2}},[t._v("至")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"approvalEnd"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束时间",editable:!1,"value-format":"yyyy-MM-dd"},model:{value:t.searchForm.approvalEnd,callback:function(e){t.$set(t.searchForm,"approvalEnd",e)},expression:"searchForm.approvalEnd"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"审核状态 :",prop:"status"}},[a("el-select",{attrs:{placeholder:"---请选择---"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.approvalState,function(t){return a("el-option",{key:t.ID,attrs:{label:t.Name,value:t.ID}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loadingBtnState.searchState},on:{click:t.paramFormat}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.resetForm("searchForm")}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("my-table",{attrs:{tableFormat:t.tableFormat,data:t.tableData,options:t.options,show:t.show},on:{approval:t.approval,approvalDetail:t.approvalDetail}}),t._v(" "),a("el-pagination",{attrs:{align:"center",background:"","current-page":t.pageindex,"page-size":t.pagesize,layout:"total, prev, pager, next",total:t.pageTotal},on:{"current-change":t.currentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"预知识审核",visible:t.approvalDialog},on:{"update:visible":function(e){t.approvalDialog=e},close:function(e){t.resetForm("approvalForm")}}},[a("el-form",{ref:"approvalForm",attrs:{model:t.approvalForm,rules:t.approvalFormRules}},[a("el-form-item",{attrs:{label:"标题 :","label-width":t.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.approvalForm.title,callback:function(e){t.$set(t.approvalForm,"title",e)},expression:"approvalForm.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"上级标题 :","label-width":t.formLabelWidth,prop:"parentTitle"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:t.approvalForm.parentTitle,callback:function(e){t.$set(t.approvalForm,"parentTitle",e)},expression:"approvalForm.parentTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"内容 :","label-width":t.formLabelWidth,prop:"content"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},on:{input:function(e){t.descInput("content")}},model:{value:t.approvalForm.content,callback:function(e){t.$set(t.approvalForm,"content",e)},expression:"approvalForm.content"}}),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"text",staticStyle:{float:"right",color:"#909399","margin-right":"55px"}},[t._v("剩余"+t._s(t.surplusWordCount.content)+"字")])],1),t._v(" "),a("el-form-item",{attrs:{label:"话术是否可复制 :","label-width":t.formLabelWidth,prop:"copyState"}},[a("el-switch",{model:{value:t.approvalForm.copyState,callback:function(e){t.$set(t.approvalForm,"copyState",e)},expression:"approvalForm.copyState"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"话术 :","label-width":t.formLabelWidth,prop:"speechTechnique"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},on:{input:function(e){t.descInput("speechTechnique")}},model:{value:t.approvalForm.speechTechnique,callback:function(e){t.$set(t.approvalForm,"speechTechnique",e)},expression:"approvalForm.speechTechnique"}}),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"text",staticStyle:{float:"right",color:"#909399","margin-right":"55px"}},[t._v("剩余"+t._s(t.surplusWordCount.speechTechnique)+"字")])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.auditAction("reject")}}},[t._v("审核不通过")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.auditAction("pass")}}},[t._v("审核通过")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"预知识详情",visible:t.detailDialog},on:{"update:visible":function(e){t.detailDialog=e},close:function(e){t.resetForm("approvalForm")}}},[a("el-form",{ref:"approvalForm",attrs:{model:t.approvalForm}},[a("el-form-item",{attrs:{label:"标题 :","label-width":t.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{readonly:!0,"auto-complete":"off"},model:{value:t.approvalForm.title,callback:function(e){t.$set(t.approvalForm,"title",e)},expression:"approvalForm.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"上级标题 :","label-width":t.formLabelWidth,prop:"parentTitle"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:t.approvalForm.parentTitle,callback:function(e){t.$set(t.approvalForm,"parentTitle",e)},expression:"approvalForm.parentTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"内容 :","label-width":t.formLabelWidth,prop:"content"}},[a("el-input",{attrs:{type:"textarea",autosize:"",readonly:!0},model:{value:t.approvalForm.content,callback:function(e){t.$set(t.approvalForm,"content",e)},expression:"approvalForm.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"话术是否可复制 :","label-width":t.formLabelWidth,prop:"copyState"}},[a("el-switch",{attrs:{disabled:!0},model:{value:t.approvalForm.copyState,callback:function(e){t.$set(t.approvalForm,"copyState",e)},expression:"approvalForm.copyState"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"话术 :","label-width":t.formLabelWidth,prop:"speechTechnique"}},[a("el-input",{attrs:{type:"textarea",autosize:"",readonly:!0},model:{value:t.approvalForm.speechTechnique,callback:function(e){t.$set(t.approvalForm,"speechTechnique",e)},expression:"approvalForm.speechTechnique"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.detailDialog=!1}}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]},d=a("VU/8")(m,u,!1,null,null,null);e.default=d.exports},woOf:function(t,e,a){t.exports={default:a("V3tA"),__esModule:!0}}});